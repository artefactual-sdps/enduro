-- create "workflow" table
CREATE TABLE `workflow` (`id` bigint NOT NULL AUTO_INCREMENT, `uuid` char(36) NOT NULL, `temporal_id` varchar(255) NOT NULL, `type` enum('unspecified','upload aip','move aip','delete aip') NOT NULL, `status` enum('unspecified','in progress','done','error','queued','pending') NOT NULL, `started_at` timestamp NULL, `completed_at` timestamp NULL, `aip_id` bigint NOT NULL, PRIMARY KEY (`id`), UNIQUE INDEX `uuid` (`uuid`), INDEX `workflow_aip_workflows` (`aip_id`), INDEX `workflow_uuid` (`uuid`), CONSTRAINT `workflow_aip_workflows` FOREIGN KEY (`aip_id`) REFERENCES `aip` (`id`) ON UPDATE NO ACTION ON DELETE CASCADE) CHARSET utf8mb4 COLLATE utf8mb4_bin;
-- create "task" table
CREATE TABLE `task` (`id` bigint NOT NULL AUTO_INCREMENT, `uuid` char(36) NOT NULL, `name` varchar(2048) NOT NULL, `status` enum('unspecified','in progress','done','error','queued','pending') NOT NULL, `started_at` timestamp NULL, `completed_at` timestamp NULL, `note` longtext NOT NULL, `workflow_id` bigint NOT NULL, PRIMARY KEY (`id`), INDEX `task_uuid` (`uuid`), INDEX `task_workflow_tasks` (`workflow_id`), UNIQUE INDEX `uuid` (`uuid`), CONSTRAINT `task_workflow_tasks` FOREIGN KEY (`workflow_id`) REFERENCES `workflow` (`id`) ON UPDATE NO ACTION ON DELETE CASCADE) CHARSET utf8mb4 COLLATE utf8mb4_bin;
